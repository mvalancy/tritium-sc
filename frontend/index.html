<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRITIUM-SC - Security Central - Intelligence Platform</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=Orbitron:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Styles (cache-bust on deploy) -->
    <link rel="stylesheet" href="/static/css/cybercore.css?v=2">
    <link rel="stylesheet" href="/static/css/tritium.css?v=2">

    <!-- Favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üëÅÔ∏è</text></svg>">
</head>
<body>
    <div class="app-container" id="app">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <span class="logo-text glitch" data-text="TRITIUM-SC">TRITIUM-SC</span>
                <span class="logo-version">v0.1.0</span>
            </div>
            <div class="header-status">
                <div id="nvr-status" class="nvr-status"></div>
                <button class="btn btn-cyber" id="editor-btn" style="padding: 4px 12px; font-size: 0.7rem;">EDITOR</button>
                <div class="system-time" id="system-time">--:--:-- UTC</div>
                <div class="connection-status">
                    <span class="connection-dot" id="connection-dot"></span>
                    <span id="connection-text">CONNECTING</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Sidebar -->
            <aside class="sidebar">
                <!-- Channels Section -->
                <div class="sidebar-section">
                    <div class="section-header">
                        <span class="section-title" onclick="toggleSection('channels')">CHANNELS</span>
                        <button class="btn btn-cyber" style="padding: 2px 8px; font-size: 0.6rem;" onclick="scanNvr()">SCAN</button>
                    </div>
                    <ul class="channel-list" id="channel-list">
                        <!-- Populated by JavaScript -->
                    </ul>
                </div>

                <!-- Dates Section -->
                <div class="sidebar-section">
                    <div class="section-header" onclick="toggleSection('dates')">
                        <span class="section-title">DATES</span>
                        <span class="section-toggle" id="dates-toggle">‚ñº</span>
                    </div>
                    <ul class="date-list" id="date-list">
                        <!-- Populated by JavaScript -->
                    </ul>
                </div>

                <!-- Zones Section -->
                <div class="sidebar-section">
                    <div class="section-header" onclick="toggleSection('sidebar-zones')">
                        <span class="section-title">ZONES</span>
                        <span class="section-toggle" id="sidebar-zones-toggle">‚ñº</span>
                    </div>
                    <ul class="tree-list" id="sidebar-zone-list">
                        <!-- Populated by JavaScript -->
                    </ul>
                </div>

                <!-- Recent Events Section -->
                <div class="sidebar-section">
                    <div class="section-header" onclick="toggleSection('events')">
                        <span class="section-title">RECENT EVENTS</span>
                        <span class="section-toggle" id="events-toggle">‚ñº</span>
                    </div>
                    <ul class="tree-list" id="event-list">
                        <!-- Populated by JavaScript -->
                    </ul>
                </div>
            </aside>

            <!-- View Area -->
            <div class="view-area">
                <!-- View Switcher -->
                <div class="view-controls" style="padding: var(--space-sm) var(--space-md); display: flex; gap: var(--space-sm); border-bottom: 1px solid rgba(0, 240, 255, 0.2); flex-wrap: wrap;">
                    <button class="btn btn-cyber active" onclick="switchView('grid')" id="btn-grid">GRID</button>
                    <button class="btn btn-cyber" onclick="switchView('player')" id="btn-player">PLAYER</button>
                    <button class="btn btn-cyber" onclick="switchView('3d')" id="btn-3d">3D VIEW</button>
                    <button class="btn btn-cyber" onclick="switchView('zones')" id="btn-zones">ZONES</button>
                    <button class="btn btn-cyber" onclick="switchView('targets')" id="btn-targets">TARGETS</button>
                    <button class="btn btn-cyber" onclick="switchView('assets')" id="btn-assets">ASSETS</button>
                    <button class="btn btn-cyber" onclick="switchView('analytics')" id="btn-analytics">ANALYTICS</button>
                    <button class="btn btn-cyber" onclick="switchView('amy')" id="btn-amy">AMY</button>
                    <button class="btn btn-cyber" onclick="switchView('scenarios')" id="btn-scenarios">SCENARIOS</button>
                    <button class="btn btn-cyber" onclick="switchView('war')" id="btn-war">WAR ROOM</button>
                    <div style="flex: 1;"></div>
                    <select id="grid-size" class="input" style="width: auto; padding: var(--space-xs) var(--space-md);">
                        <option value="1">1x1</option>
                        <option value="4" selected>2x2</option>
                        <option value="6">3x2</option>
                        <option value="9">3x3</option>
                    </select>
                </div>

                <!-- Grid View -->
                <div class="view-content" id="view-grid">
                    <div class="video-grid grid-4" id="video-grid">
                        <!-- Video cells populated by JavaScript -->
                    </div>
                </div>

                <!-- Player View -->
                <div class="view-content hidden" id="view-player">
                    <div class="player-container">
                        <div class="player-wrapper">
                            <video id="main-player" controls></video>
                        </div>
                        <div class="player-controls">
                            <button class="play-btn" id="play-btn" onclick="togglePlay()">‚ñ∂</button>
                            <div class="timeline" id="timeline" onclick="seekTo(event)">
                                <div class="timeline-progress" id="timeline-progress"></div>
                                <div class="timeline-events" id="timeline-events"></div>
                            </div>
                            <div class="time-display">
                                <span id="current-time">00:00:00</span> / <span id="duration">00:00:00</span>
                            </div>
                            <button class="btn btn-cyber active" id="btn-toggle-annotations" onclick="toggleAnnotations()" title="Toggle detection boxes (A)">
                                ‚óª DETECTIONS
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 3D View -->
                <div class="view-content hidden" id="view-3d">
                    <canvas id="three-canvas"></canvas>
                    <div class="canvas-overlay" style="position: absolute; top: var(--space-md); left: var(--space-md);">
                        <div class="panel" style="padding: var(--space-sm);">
                            <span class="text-cyan">3D CAMERA GRID</span>
                        </div>
                    </div>
                </div>

                <!-- Zones View -->
                <div class="view-content hidden" id="view-zones">
                    <div class="zones-container" style="display: grid; grid-template-columns: 300px 1fr; height: 100%; gap: var(--space-md); padding: var(--space-md);">
                        <!-- Zone List Panel -->
                        <div class="panel" style="overflow-y: auto;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                                <span class="text-cyan" style="font-weight: bold;">MONITORING ZONES</span>
                                <button class="btn btn-cyber" onclick="startZoneDrawing()" id="btn-draw-zone">+ DRAW</button>
                            </div>
                            <div id="zone-list" class="tree-list">
                                <!-- Zones populated by JavaScript -->
                            </div>
                        </div>

                        <!-- Zone Canvas / Camera View -->
                        <div class="panel" style="position: relative; overflow: hidden;">
                            <div id="zone-editor-container" style="width: 100%; height: 100%; background: #0a0a0f;">
                                <div class="empty-state" id="zone-empty-state">
                                    <div class="empty-state-icon">üìç</div>
                                    <div class="empty-state-title">SELECT A CAMERA</div>
                                    <div class="empty-state-message">
                                        Select a camera from the sidebar to draw monitoring zones.<br>
                                        Zones track specific areas: dumpsters, doors, pathways, etc.
                                    </div>
                                </div>
                                <video id="zone-background-video" style="width: 100%; height: 100%; object-fit: contain; display: none;"></video>
                                <img id="zone-background-image" style="width: 100%; height: 100%; object-fit: contain; display: none;">
                            </div>
                        </div>
                    </div>

                    <!-- Zone Events Timeline -->
                    <div class="panel" style="margin: 0 var(--space-md) var(--space-md); padding: var(--space-md); max-height: 200px; overflow-y: auto;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-sm);">
                            <span class="text-magenta" style="font-weight: bold;">ZONE EVENTS</span>
                            <span id="zone-event-count" class="text-cyan">0 events</span>
                        </div>
                        <div id="zone-events-list" class="tree-list">
                            <div class="text-muted">Select a zone to view events</div>
                        </div>
                    </div>
                </div>

                <!-- Targets View (People/Vehicle Gallery) -->
                <div class="view-content hidden" id="view-targets">
                    <div class="targets-container" style="display: flex; flex-direction: column; height: 100%; padding: var(--space-md); gap: var(--space-md);">
                        <!-- Target Type Tabs and Filters -->
                        <div class="panel" style="padding: var(--space-md);">
                            <div style="display: flex; align-items: center; gap: var(--space-md); flex-wrap: wrap;">
                                <div class="target-tabs" style="display: flex; gap: var(--space-sm);">
                                    <button class="btn btn-cyber active" onclick="setTargetType('people')" id="btn-target-people">
                                        <span style="margin-right: 4px;">üë§</span> PEOPLE
                                    </button>
                                    <button class="btn btn-cyber" onclick="setTargetType('vehicles')" id="btn-target-vehicles">
                                        <span style="margin-right: 4px;">üöó</span> VEHICLES
                                    </button>
                                </div>
                                <div style="flex: 1;"></div>
                                <div class="target-filters" style="display: flex; gap: var(--space-sm); align-items: center;">
                                    <select id="target-channel-filter" class="input" style="width: auto; padding: var(--space-xs) var(--space-sm);">
                                        <option value="">All Channels</option>
                                    </select>
                                    <input type="date" id="target-date-filter" class="input" style="width: auto; padding: var(--space-xs) var(--space-sm);">
                                    <button class="btn btn-cyber" onclick="loadTargets()" style="padding: var(--space-xs) var(--space-sm);">REFRESH</button>
                                </div>
                                <div class="target-stats" style="font-size: 0.8rem;">
                                    <span id="target-count" class="text-cyan">0</span> targets
                                </div>
                            </div>
                        </div>

                        <!-- Target Gallery Grid -->
                        <div class="panel" style="flex: 1; overflow-y: auto; padding: var(--space-md);">
                            <div id="target-gallery" class="target-gallery" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: var(--space-md);">
                                <!-- Target cards populated by JavaScript -->
                                <div class="empty-state" id="targets-empty">
                                    <div class="empty-state-icon">üîç</div>
                                    <div class="empty-state-title">NO TARGETS FOUND</div>
                                    <div class="empty-state-message">
                                        Run AI analysis on videos to detect people and vehicles.<br>
                                        Select a channel and date, then click "Analyze" in the sidebar.
                                    </div>
                                </div>
                            </div>
                            <!-- Load More -->
                            <div id="target-load-more" style="text-align: center; padding: var(--space-md); display: none;">
                                <button class="btn btn-cyber" onclick="loadMoreTargets()">LOAD MORE</button>
                            </div>
                        </div>

                        <!-- Target Detail Panel (shown when target selected) -->
                        <div id="target-detail-panel" class="panel" style="display: none; padding: var(--space-md);">
                            <div style="display: flex; gap: var(--space-md);">
                                <div id="target-detail-image" style="width: 200px; height: 200px; background: #1a1a2e; display: flex; align-items: center; justify-content: center;">
                                    <img id="target-detail-img" style="max-width: 100%; max-height: 100%; object-fit: contain;">
                                </div>
                                <div style="flex: 1;">
                                    <h3 id="target-detail-title" class="text-cyan" style="margin: 0 0 var(--space-sm) 0;">Target Details</h3>
                                    <div id="target-detail-info" style="font-size: 0.85rem; line-height: 1.6;">
                                        <!-- Populated by JS -->
                                    </div>
                                    <div style="margin-top: var(--space-md); display: flex; gap: var(--space-sm);">
                                        <button class="btn btn-cyber" onclick="labelTarget()">LABEL</button>
                                        <button class="btn btn-cyber" onclick="findSimilar()">FIND SIMILAR</button>
                                        <button class="btn btn-cyber" onclick="closeTargetDetail()" style="margin-left: auto;">CLOSE</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Assets View (Autonomous Units) -->
                <div class="view-content hidden" id="view-assets">
                    <div class="assets-container" style="display: grid; grid-template-columns: 350px 1fr; height: 100%; gap: var(--space-md); padding: var(--space-md);">
                        <!-- Asset List Panel -->
                        <div class="panel" style="overflow-y: auto; display: flex; flex-direction: column;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                                <span class="text-cyan" style="font-weight: bold;">OPERATIONAL ASSETS</span>
                                <button class="btn btn-cyber" onclick="showAddAssetModal()" style="padding: 4px 8px; font-size: 0.7rem;">+ REGISTER</button>
                            </div>
                            <div id="asset-list" class="asset-list" style="flex: 1; overflow-y: auto;">
                                <!-- Assets populated by JavaScript -->
                            </div>
                            <div class="asset-summary" style="border-top: 1px solid rgba(0, 240, 255, 0.2); padding-top: var(--space-sm); margin-top: var(--space-sm);">
                                <div style="display: flex; justify-content: space-between; font-size: 0.75rem;">
                                    <span>Total: <span id="asset-total" class="text-cyan">0</span></span>
                                    <span>Active: <span id="asset-active" class="text-green">0</span></span>
                                    <span>Offline: <span id="asset-offline" class="text-magenta">0</span></span>
                                </div>
                            </div>
                        </div>

                        <!-- Asset Detail / Control Panel -->
                        <div class="panel" style="display: flex; flex-direction: column; overflow: hidden;">
                            <!-- Asset Header -->
                            <div id="asset-detail-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                                <div>
                                    <span id="asset-detail-name" class="text-cyan" style="font-size: 1.2rem; font-weight: bold;">SELECT AN ASSET</span>
                                    <span id="asset-detail-status" class="badge" style="margin-left: 8px;">--</span>
                                </div>
                                <div id="asset-detail-actions" style="display: none;">
                                    <button class="btn btn-cyber" onclick="recallAsset()" style="margin-right: 4px;">RECALL</button>
                                    <button class="btn btn-cyber" onclick="emergencyStop()" style="background: rgba(255, 42, 109, 0.2);">E-STOP</button>
                                </div>
                            </div>

                            <!-- Asset Info Grid -->
                            <div id="asset-detail-info" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-sm); margin-bottom: var(--space-md);">
                                <div class="stat-box">
                                    <div class="stat-label">BATTERY</div>
                                    <div class="stat-value" id="asset-battery">--%</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">ORDNANCE</div>
                                    <div class="stat-value" id="asset-ammo">--%</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">POSITION</div>
                                    <div class="stat-value" id="asset-position">--</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-label">HEADING</div>
                                    <div class="stat-value" id="asset-heading">--¬∞</div>
                                </div>
                            </div>

                            <!-- Camera Feed / Map -->
                            <div style="flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md); min-height: 300px;">
                                <div class="panel" style="background: #0a0a0f; position: relative;">
                                    <div style="position: absolute; top: 4px; left: 8px; font-size: 0.65rem; color: var(--cyan);">ONBOARD CAMERA</div>
                                    <div id="asset-camera-feed" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
                                        <span class="text-muted">No feed available</span>
                                    </div>
                                </div>
                                <div class="panel" style="background: #0a0a0f; position: relative;">
                                    <div style="position: absolute; top: 4px; left: 8px; font-size: 0.65rem; color: var(--cyan);">TACTICAL MAP</div>
                                    <canvas id="asset-map-canvas" style="width: 100%; height: 100%;"></canvas>
                                </div>
                            </div>

                            <!-- Task Assignment -->
                            <div style="margin-top: var(--space-md); border-top: 1px solid rgba(0, 240, 255, 0.2); padding-top: var(--space-md);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-sm);">
                                    <span class="text-magenta" style="font-weight: bold;">TASK ASSIGNMENT</span>
                                    <span id="asset-current-task" class="text-muted">No active task</span>
                                </div>
                                <div class="task-buttons" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-sm);">
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('patrol')" data-task="patrol">
                                        <span>üîÑ</span> PATROL
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('track')" data-task="track">
                                        <span>üéØ</span> TRACK
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('engage')" data-task="engage">
                                        <span>‚ö°</span> ENGAGE
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('loiter')" data-task="loiter">
                                        <span>üìç</span> LOITER
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('investigate')" data-task="investigate">
                                        <span>üîç</span> INVESTIGATE
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('recall')" data-task="recall">
                                        <span>üè†</span> RECALL
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="assignTask('rearm')" data-task="rearm">
                                        <span>üîã</span> REARM
                                    </button>
                                    <button class="btn btn-cyber task-btn" onclick="cancelCurrentTask()" style="background: rgba(255, 42, 109, 0.15);">
                                        <span>‚úñ</span> CANCEL
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Analytics View -->
                <div class="view-content hidden" id="view-analytics">
                    <div class="analytics-container" style="display: flex; flex-direction: column; height: 100%; padding: var(--space-md); gap: var(--space-md); overflow-y: auto;">
                        <!-- Analytics Header -->
                        <div class="panel" style="padding: var(--space-md);">
                            <div style="display: flex; align-items: center; gap: var(--space-md); flex-wrap: wrap;">
                                <h2 class="text-cyan" style="margin: 0;">DETECTION ANALYTICS</h2>
                                <div style="flex: 1;"></div>
                                <div style="display: flex; gap: var(--space-sm); align-items: center;">
                                    <label class="text-muted" style="font-size: 0.75rem;">PERIOD:</label>
                                    <select id="analytics-days" class="input" style="width: auto; padding: var(--space-xs) var(--space-sm);" onchange="loadAnalytics()">
                                        <option value="7" selected>7 Days</option>
                                        <option value="14">14 Days</option>
                                        <option value="30">30 Days</option>
                                    </select>
                                    <button class="btn btn-cyber" onclick="loadAnalytics()">REFRESH</button>
                                </div>
                            </div>
                        </div>

                        <!-- Stats Summary -->
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: var(--space-md);">
                            <div class="panel stat-box" style="padding: var(--space-lg);">
                                <div class="stat-label">TOTAL DETECTIONS</div>
                                <div class="stat-value text-cyan" id="analytics-total" style="font-size: 2rem;">0</div>
                            </div>
                            <div class="panel stat-box" style="padding: var(--space-lg);">
                                <div class="stat-label">PEOPLE DETECTED</div>
                                <div class="stat-value text-magenta" id="analytics-people" style="font-size: 2rem;">0</div>
                            </div>
                            <div class="panel stat-box" style="padding: var(--space-lg);">
                                <div class="stat-label">VEHICLES DETECTED</div>
                                <div class="stat-value text-yellow" id="analytics-vehicles" style="font-size: 2rem;">0</div>
                            </div>
                            <div class="panel stat-box" style="padding: var(--space-lg);">
                                <div class="stat-label">PEAK HOUR</div>
                                <div class="stat-value text-green" id="analytics-peak" style="font-size: 2rem;">--</div>
                            </div>
                        </div>

                        <!-- Charts Row -->
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-md);">
                            <!-- Daily Chart -->
                            <div class="panel" style="padding: var(--space-md);">
                                <div class="text-muted" style="margin-bottom: var(--space-sm); font-size: 0.75rem;">DAILY DETECTIONS</div>
                                <div id="analytics-daily-chart" style="height: 200px; display: flex; align-items: flex-end; gap: 4px; background: rgba(0,0,0,0.3); padding: var(--space-sm); border-radius: 4px;">
                                    <!-- Bars generated by JS -->
                                </div>
                                <div id="analytics-daily-labels" style="display: flex; justify-content: space-between; font-size: 0.6rem; color: var(--text-muted); margin-top: 4px;"></div>
                            </div>

                            <!-- Hourly Distribution -->
                            <div class="panel" style="padding: var(--space-md);">
                                <div class="text-muted" style="margin-bottom: var(--space-sm); font-size: 0.75rem;">HOURLY DISTRIBUTION</div>
                                <div id="analytics-hourly-chart" style="height: 200px; display: flex; align-items: flex-end; gap: 2px; background: rgba(0,0,0,0.3); padding: var(--space-sm); border-radius: 4px;">
                                    <!-- Bars generated by JS -->
                                </div>
                                <div style="display: flex; justify-content: space-between; font-size: 0.6rem; color: var(--text-muted); margin-top: 4px;">
                                    <span>00</span>
                                    <span>06</span>
                                    <span>12</span>
                                    <span>18</span>
                                    <span>24</span>
                                </div>
                            </div>
                        </div>

                        <!-- Recent Targets -->
                        <div class="panel" style="padding: var(--space-md);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-sm);">
                                <span class="text-magenta" style="font-weight: bold;">RECENT TARGETS (TODAY)</span>
                                <button class="btn btn-cyber" onclick="switchView('targets')" style="padding: 4px 8px; font-size: 0.7rem;">VIEW ALL ‚Üí</button>
                            </div>
                            <div id="analytics-recent-targets" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: var(--space-sm); max-height: 200px; overflow-y: auto;">
                                <!-- Recent targets populated by JS -->
                            </div>
                        </div>

                        <!-- Channel Breakdown -->
                        <div class="panel" style="padding: var(--space-md);">
                            <div class="text-muted" style="margin-bottom: var(--space-sm); font-size: 0.75rem;">DETECTIONS BY CHANNEL</div>
                            <div id="analytics-channels" style="display: flex; flex-wrap: wrap; gap: var(--space-md);">
                                <!-- Channel stats populated by JS -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Amy AI Commander View -->
                <div class="view-content hidden" id="view-amy">
                    <!-- Populated by amy.js -->
                </div>

                <!-- Scenarios View -->
                <div class="view-content hidden" id="view-scenarios">
                    <!-- Populated by scenarios.js -->
                </div>

                <!-- War Room View -->
                <div class="view-content hidden" id="view-war">
                    <canvas id="war-canvas"></canvas>
                    <!-- HUD overlays positioned absolutely over canvas -->
                    <div id="war-hud" style="position: absolute; inset: 0; pointer-events: none;">
                        <!-- Address bar -->
                        <div id="war-address-bar" class="war-address-bar" style="pointer-events: auto;">
                            <input type="text" id="war-address-input" placeholder="Enter address to load satellite map..." autocomplete="off">
                            <button id="war-address-btn" class="btn btn-cyber" onclick="warLoadAddress()">GEOCODE</button>
                            <span id="war-address-status" class="war-address-status"></span>
                        </div>
                        <!-- Mode selector -->
                        <div id="war-mode-selector" class="war-mode-selector" style="pointer-events: auto;">
                            <button id="war-mode-sim" class="war-mode-btn active" onclick="warSetSimMode('sim')">SIM</button>
                            <button id="war-mode-live" class="war-mode-btn" onclick="warSetSimMode('live')">LIVE</button>
                        </div>
                        <div id="war-mode" style="position: absolute; top: 12px; left: 50%; transform: translateX(-50%); pointer-events: auto;"></div>
                        <div id="war-amy-toast" style="position: absolute; top: 48px; left: 50%; transform: translateX(-50%); pointer-events: none; opacity: 0; transition: opacity 0.3s;"></div>
                        <div id="war-unit-info" style="position: absolute; top: 60px; left: 12px; width: 260px; pointer-events: auto; display: none;"></div>
                        <div id="war-amy-panel" style="position: absolute; top: 60px; right: 12px; width: 280px; pointer-events: auto;"></div>
                        <div id="war-alert-log" style="position: absolute; bottom: 12px; right: 12px; width: 300px; max-height: 250px; pointer-events: auto; overflow-y: auto;"></div>
                        <div id="war-setup-palette" style="position: absolute; top: 60px; left: 12px; width: 220px; pointer-events: auto; display: none;"></div>
                    </div>
                </div>

                <!-- Video List (when a date is selected) -->
                <div class="view-content hidden" id="view-list">
                    <div class="video-list" id="video-list">
                        <!-- Populated by JavaScript -->
                    </div>
                </div>

                <!-- Empty State -->
                <div class="view-content hidden" id="view-empty">
                    <div class="empty-state">
                        <div class="empty-state-icon">üìπ</div>
                        <div class="empty-state-title">NO CHANNEL SELECTED</div>
                        <div class="empty-state-message">
                            Select a channel from the sidebar to browse recordings or view live streams.
                        </div>
                    </div>
                </div>

                <!-- Timeline Bar -->
                <div class="timeline-bar" id="timeline-bar">
                    <div class="timeline-header">
                        <span class="timeline-date" id="timeline-date">SELECT A DATE</span>
                    </div>
                    <div class="timeline-track" id="day-timeline">
                        <!-- Timeline segments populated by JavaScript -->
                    </div>
                    <div class="timeline-hours">
                        <span>00</span>
                        <span>06</span>
                        <span>12</span>
                        <span>18</span>
                        <span>24</span>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer / Command Bar -->
        <footer class="footer">
            <div class="command-input">
                <span class="command-prompt">&gt;</span>
                <input type="text" id="command-input" placeholder="search: person red jacket yesterday" autocomplete="off">
                <span class="command-hint">[ENTER]</span>
            </div>
        </footer>

        <!-- Notifications Container -->
        <div class="notification-container" id="notifications"></div>

        <!-- Controls Hint Button -->
        <button class="controls-hint" onclick="tritiumInput.toggleHelp()" title="Show Controls (? or SELECT)">
            <kbd>?</kbd> CONTROLS
        </button>

        <!-- Gamepad Connection Indicator -->
        <div class="gamepad-indicator" id="gamepad-indicator">
            <span class="icon">üéÆ</span>
            <span class="text">Gamepad Connected</span>
        </div>
    </div>

    <!-- Three.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

    <!-- Application Scripts -->
    <script src="/static/js/app.js?v=3"></script>
    <script src="/static/js/input.js?v=2"></script>
    <script src="/static/js/grid.js?v=2"></script>
    <script src="/static/js/player.js?v=2"></script>
    <script src="/static/js/zone-editor.js?v=2"></script>
    <script src="/static/js/zones.js?v=2"></script>
    <script src="/static/js/targets.js?v=2"></script>
    <script src="/static/js/assets.js?v=2"></script>
    <script src="/static/js/analytics.js?v=2"></script>
    <script src="/static/js/amy.js?v=3"></script>
    <script src="/static/js/scenarios.js?v=2"></script>
    <script src="/static/js/models.js?v=1"></script>
    <script src="/static/js/geo.js?v=1"></script>
    <script src="/static/js/war3d.js?v=1"></script>
    <script src="/static/js/war-editor.js?v=1"></script>
    <script src="/static/js/war.js?v=5"></script>

    <!-- Level Editor (games-common modules) -->
    <script src="/static/common/js/editor/AssetRegistry.js"></script>
    <script src="/static/common/js/editor/LevelSerializer.js"></script>
    <script src="/static/common/js/editor/UndoManager.js"></script>
    <script src="/static/common/js/editor/TransformGizmo.js"></script>
    <script src="/static/common/js/editor/ViewCube.js"></script>
    <script src="/static/common/js/editor/EditorSkyDome.js"></script>
    <script src="/static/common/js/editor/EditorStyles.js"></script>
    <script src="/static/common/js/editor/EditorUI.js"></script>
    <script src="/static/common/js/editor/ProceduralAssets.js"></script>
    <script src="/static/common/js/editor/GLTFBridge.js"></script>
    <script src="/static/common/js/editor/BlenderBridge.js"></script>
    <script src="/static/common/js/editor/SceneHierarchy.js"></script>
    <script src="/static/common/js/editor/RegionTools.js"></script>
    <script src="/static/common/js/editor/TerrainSystem.js"></script>
    <script src="/static/common/js/editor/EditorCore.js"></script>
    <!-- Level Editor (tritium-sc plugin) -->
    <script src="/static/js/editor/TritiumLevelFormat.js"></script>
    <script src="/static/js/editor/TritiumAssets.js"></script>
    <script src="/static/js/editor/TritiumEditorPlugin.js"></script>

    <script>
        // Editor lazy init
        let tritiumEditor = null;
        document.getElementById('editor-btn')?.addEventListener('click', () => {
            if (!tritiumEditor) {
                console.log('[TRITIUM] Initializing Battlespace Editor...');
                tritiumEditor = createTritiumEditor(document.body, TRITIUM);
                tritiumEditor.init();
            }
            tritiumEditor.show();
        });
    </script>
</body>
</html>
